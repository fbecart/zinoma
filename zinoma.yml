targets:
  test:
    inputs:
      - fs_path: Cargo.lock
      - fs_path: Cargo.toml
      - fs_path: src
      - fs_path: tests
    build: cargo test

  clippy:
    inputs: [{ fs_path: src }]
    build: cargo clippy

  no-unused-dependencies:
    dependencies: [clippy]
    inputs: [{ fs_path: Cargo.toml }, { fs_path: src }, { fs_path: tests }]
    build: cargo +nightly udeps

  fmt:
    inputs: [{ fs_path: src }, { fs_path: tests }]
    build: cargo fmt --all -- --check

  check:
    dependencies: [test, clippy, no-unused-dependencies, fmt]

  install:
    dependencies: [check]
    build: cargo install --path .
